# 1장 컴퓨터는 데이터에서 배운다

이장에서는 다음 주제를 다룬다.

1. 머신러닝의 일반적인 개념 이해하기
2. 세 종류의 학습과 기본 용어 알아보기
3. 성공적인 머신러닝 시스템을 설계하는 필수 요소 알아보기
4. 데이터 분석과 머신러닝을 위한 파이썬을 설치하고 설정하기

## 1.1 데이터를 지식으로 바꾸는 지능적인 시스템 구축

- 비정형, 정형 데이터로부터 <font  color="red">지식을 추출</font>하여 <font  color="red">예측</font>을 하는 자기학습 알고리즘을 머신러닝이라고 하고 이는 인공지능의 하위 분류이다. 


- 머신러닝에서 효율적으로 지식을 추출하여 예측 모델과 의사결정 성능을 향상시키는 것이 목표이다.

## 1.2 머신러닝의 세가지 종류 

- 머신러닝에는 지도 학습(supervised learning), 비지도 학습(unsupervised learning), 강화학습(reinforcement learning) 총 세가지 학습 방법이 있다. 

1. 지도학습: 지도학습은 정답이 있는 데이터에서 지식을 추출하여 이를 통해 학습하고, 새로운 데이터를 예측하는 것이다. 학습과정에서 정답이 존재하기 때문에 피드백이 존재한다.

2. 비지도 학습: 비지도 학습은 정답이 없는 데이터에서 지식을 추출하여 이를 통해 학습하고, 데이터의 숨겨진 구조를 찾는 것이다. 학습과정에서 정답이 없기 때문에 피드백이 없다.

3. 강화학습: 목표가 있고, 이 목표를 이루기 위해서 행동을 하고, 행동으로부터 보상을 얻으며, 이를 얻기 위한 방향으로 학습한다.

![image-2.png](attachment:image-2.png)

### 1.2.1 지도 학습으로 미래 예측

- 지도학습은 이전의 레이블된 데이터를 통해 학습한 후 새로운 데이터에 대한 예측을 하는 것이다. 그 과정은 다음과 같다.

![image.png](attachment:image.png)

- 예시를 들어 살펴보자. 스팸 메일을 분류하기 위한 머신러닝 알고리즘을 만든다고 할때, 먼저 학습을 위한 스팸 메일과 일반 메일의 데이터(레이블된 데이터)가 필요하다. 이 데이터에서 지식을 추출하여 학습한다. 이후 새로운 데이터가 들어오면 이를 학습된 모델(예측 모델)을 통해 스팸 메일인지 아닌지 분류한다.


- 또다른 예측으로는 성적과 공부시간을 통해 학생의 성적을 예측해보는 것이 있다. 이 때 학습들의 성적과 공부시간(레이블된 데이터)가 필요하다. 이 데이터에서 지식을 추출하여 학습한다. 이 후 시험을 칠 때 학습시간을 통해서 학생의 성적을 예측할 수 있다.

- 위의 예시에서 보인 것처럼 지도학습에는 두 가지로 구분된다. 각 데이터에 대해 개별 클래스 레이블이 있는 분류(Classification)과 연속적인 값을 출력하는 회귀(Regression)이 있다.

![image.png](attachment:image.png)

#### 분류: 클래스 레이블 예측

- 먼저 분류를 살펴보면, 분류에는 위의 스팸분류처럼 두개의 범주로 분류하는 이진 분류(binary classification)가 있고, 두 개 이상의 범주로 분류하는 다중 분류(multiclass classification)이 있다.

#### 회귀: 연속적인 출력 값 예측

- 연속적인 출력 값을 예측하는 회귀 분석이 있다. 회귀는 예측 변수(predictor variable또는 설명 변수(explanatory variable)), 입력(input))와 연속적인 반응 변수(response variable)(또는 출력(outcome), 타깃(target))가 주어졌을 때 출력 값을 예측하는 두 변수 사이의 관계를 찾습니다.

### 1.2.2 강화 학습으로 반응형 문제 해결

- 강화학습은 환경에서 현재의 상태(state)와 상호작용하여 에이전트(aegnt)가 행동(action)을 하고 새로운 상태가 주어지고, 이를 바탕으로 보상(reward)를 지급한다. 그렇기 때문에 별도의 레이블이 존재하지 않는다. 이것은 시행착오(학습)를 거치면서 더 많은 보상을 얻기 위해 행동한다.

![image-3.png](attachment:image-3.png)

### 1.2.3 비지도 학습으로 숨겨진 구조 발견

- 지도학습과 강화학습과는 다르게 무언가 좋다라는 판단을 내리는 것이 아니라 데이터로부터 정보를 추출하기 위해 데이터 구조를 탐색하는 것이다.

#### 군집: 서브그룹 찾기

- 군집은 정보들을 의미 있는 서브그룹 또는 클러스터(cluster)로 조직하는 탐색적 데이터 분석 기법이다. 

- 마케팅에서 흔히 예시를 찾을 수 있다. 예를들어 고기를 사는 고객은 소금도 같이 산다는 데이터를 통해 고기와 소금을 같이 배치하는 등의 방법이 있다.

![image-2.png](attachment:image-2.png)

#### 차원 축소: 데이터 압축

- 고차원의 데이터를 다루어야 하는 경우는 흔하다. 즉, 하나의 관측 샘플에 많은 측정 지표가 있다. 이로 인해 머신 러닝 알고리즘의 계산 성능과 저장 공간의 한계에 맞닥뜨릴 수 있다. 


- 이를 통해 주요한 정보들을 유지하면서 더 작은 차원의 부분 공간으로 데이터를 압축한다. 이 때 예측 성능에 영향을 줄 수 있는 잡음 데이터를 제거할 수 있고, 계산량을 줄일 수 있다.

![image.png](attachment:image.png)

## 1.3 기본 용어와 표기법 소개

- 머신러닝에서 상요되는 기본 용어와 표기법에 대해 알아보자. 이를 설명하기 위해 붓꽃 데이터셋(Iris dataset)을 통해 설명하겠다. 붓꽃 데이터셋은 Setosa, Versicolor, Virginica 세 종류 150개의 붓꽃 샘플을 담고 있습니다. 각 붓꽃 샘플은 데이터셋에서 하나의 행(row)으로 표현된다. 센티미터 단위의 측정값은 열(column)에 저장되어 있으며 데이터셋의 특성(feature)이라고 한다. 

![image.png](attachment:image.png)

- 간단하고 효율적으로 표기하고 코드를 구현할 수 있도록 기초적인 선형대수학(linear algebra)을 사용한다. 다음 장부터는 행렬(matrix)과 벡터(vector) 표기로 데이터를 표현한다. 일반적인 관례에 따라서 샘플은 특성 행렬 X에 있는 행으로 나타내고, 특성은 열을 따라 저장한다.




- 150개의 샘플과 네 개의 특성을 가진 붓꽃 데이터셋은 150×4 크기의 행렬 로 쓸 수 있습니다.

![image.png](attachment:image.png)

![image.png](attachment:image.png)

## 1.4 머신 러닝 시스템 구축 로드맵

- 예측 모델링에 머신 러닝을 사용하는 전형적인 작업 흐름을 보여 준다.

![image.png](attachment:image.png)

### 1.4.1 전처리: 데이터 형태 갖추기

- 주어진 원본 데이터를 바로 학습에 사용되기는 어렵다. 그렇기 때문에 데이터 전처리 과정을 거쳐야된다. 예시로 붓꽃 데이터를 통해 설명하면 유용한 특성인 꽃의 색깔, 색조, 채도, 꽃의 길이 너비 등의 특성을 선택한다. 그리고 특성은 같은 스케일을 가져야되기에 rescale해주는게 일반적이다. 이때 일반적으로 0~1사이의 값으로 변환하거나 평균이 0이고 단위분산을 가진 표준 정규 분포로 변환하는 경우가 많다.

- 일부 선택된 특성은 매우 상관관계가 높아 어느 정도 중복된 정보를 가질 수 있다. 이때는 차원 축소 기법을 사용하여 특성을 저차원 부분 공간으로 압축한다. 특성 공간의 차원을 축소하면 저장 공간이 덜 필요하고 학습 알고리즘을 더 빨리 실행할 수 있다. 어떤 경우에는 차원 축소가 모델의 예측 성능을 높이기도 한다다.

- 이렇게 변환시킨 데이터를 훈련데이터와 테스트 데이터로 나누어준다. 모델을 훈련데이터를 통해 학습시킨후에 학습시킨 모델이 제대로 학습되었는지 확인하기 위해 테스트 데이터로 검증해준다. 이후에 새로운 데이터를 통해 예측하는 과정을 거친다.

### 1.4.2 예측 모델 훈련과 선택

#### metrics

- 모델 선택 및 훈련에 대해 얘기하전에 먼저 측정 지표에 대해서 얘기해보자. 어떤 모델을 훈련시켰는데 이것의 성능을 평가할 방법이 없다면 이 모델이 얼마나 좋은 것인지 판단할 수 없다. 그렇기에 측정 지표가 필요한데, 가장 흔히 사용되는 것이 정확도(accuracy)이다. 

- 모델 선택에 테스트 세트를 사용하지 않고 최종 모델을 평가하려고 따로 보관한다면, 테스트 세트와 실제 데이터에서 어떤 모델이 잘 동작하는지 확인하기 위해 교차 검증 기법(cross validation)을 이용한다. 새로운 데이터에 대해서 잘 작동하려면 모델이 일반화가 잘되어야 된다.

![image.png](attachment:image.png)

- 교차검증방법: 일반화 성능을 확인하기 위해서 훈련 데이터를 훈련 세트와 검증 세트로 더 나누어서 학습을 진행한다. 

![image.png](attachment:image.png)

- 교차검증을 할때 기존에 제공되는 라이브러리에서 사용되는 하이퍼 파라미터를 이용하기도 하지만 더 좋은 하이퍼 파라미터가 있을 수 있으니 이를 수정하여 사용할 수 있다.

*하이퍼 파라미터는 모델링할 때 사용자가 직접 세팅해주는 값을 뜻합니다.*

### 1.4.3 모델을 평가하고 본 적 없는 샘플로 예측

- 훈련 데이터를 통해 학습시킨 모델이 해당 데이터에만 유용한지 판단하기 위해 테스트 데이터를 통해 일반화 성능을 판단하고, 충분한 성능을 보인다면 새로운 데이터를 통해 예측하여 본다. 

## 1.5 머신 러닝을 위한 파이썬

- 데이터를 전처리하고, 머신러닝 모델을 구현 및 학습하고, 모델을 검증 및 예측에 사용하기 위해 하나하나 코드를 작성하면 매우 힘들어 진다. 그렇기 때문에 이미 존재하는 라이브러리를 이용한다.


- 라이브러리를 다운할때는 pip 혹은 conda를 이용하여 다운하는데  **pip install 라이브러리이름**, **conda install 라이브러리이름**을 통해 라이브러리를 다운 받을 수 있다. 

다음 라이브러리를 다운 받아보자


• NumPy 1.16.1

• SciPy 1.2.1

• Scikit-learn 0.20.2

• Matplotlib 3.0.2

• Pandas 0.24.1

• TensorFlow 2.0.0-alpha0
